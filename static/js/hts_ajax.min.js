function getCookie(e){let t=null;if(document.cookie&&""!==document.cookie){const n=document.cookie.split(";");for(let m=0;m<n.length;m++){const d=n[m].trim();if(d.substring(0,e.length+1)===e+"="){t=decodeURIComponent(d.substring(e.length+1));break}}}return t}const csrftoken=getCookie("csrftoken");function csrfSafeMethod(e){return/^(GET|HEAD|OPTIONS|TRACE)$/.test(e)}function send_ajax(){$.ajax({type:"GET",async:!0,url:"/htc/",cache:!1,dataType:"json",data:{time:document.getElementById("htc_value_1").innerHTML}}).done((function(e){1==e.success&&(document.getElementById("htc_value_1").innerHTML=e.last_date,document.getElementById("htc_value_2").innerHTML=e.water,document.getElementById("htc_value_3").innerHTML=e.smoke,document.getElementById("htc_value_4").innerHTML=e.outside_temp);var t=document.getElementsByClassName("status")[0];1==e.status?t.style.display="none":t.style.display="inline"}))}function startTime(){document.getElementById("time_now").innerHTML=getTimeNow(),t=setTimeout(startTime,1e3)}function checkTime(e){return e<10&&(e="0"+e),e}function getTimeNow(){let e=new Date,t=e.getHours(),n=e.getMinutes(),m=e.getSeconds();return n=checkTime(n),m=checkTime(m),t+":"+n+":"+m}function soundClick(){let e=new Audio;e.src=audio_dir+"sound1.ogg",e.play()}function start(){let e=document.getElementById("set_time").value;document.getElementById("time").innerHTML=60*e,document.getElementById("set_time").disabled=!0,document.getElementById("task").disabled=!0,document.getElementById("start").style.display="none",document.getElementById("stop").disabled=!1,document.getElementById("pause").style.display="inline";new Date;document.getElementById("history").innerHTML+="<p>START:  <b>"+getTimeNow()+"</b> - "+document.getElementById("task").value+"</p>",startTimer()}function startTimer(){let e=document.getElementById("time").innerText;e=--e;let t=e/60>>0,n=e-60*t;document.getElementById("minutes").innerHTML=t,document.getElementById("seconds").innerHTML=n,document.getElementById("time").innerHTML=e,"undefined"!=typeof tt&&clearTimeout(tt),tt=setTimeout(startTimer,1e3),e<1&&(clearTimeout(tt),soundClick(),document.getElementById("set_time").value=parseInt(document.getElementById("set_time").value)+1,console.log(document.getElementById("set_time").value),stop())}$.ajaxSetup({beforeSend:function(e,t){csrfSafeMethod(t.type)||this.crossDomain||e.setRequestHeader("X-CSRFToken",csrftoken)}}),setTimeout(send_ajax,1e3),setTimeout(startTime,1e3);let paused=!1;function pauseTimer(){if(1!=paused){clearTimeout(tt),paused=!0,document.getElementById("pause").innerHTML="start";document.getElementById("set_time").value,parseInt(document.getElementById("minutes").innerText);document.getElementById("history").innerHTML+="<p>PAUSE: <b>"+getTimeNow()+"</b></p>"}else tt=setTimeout(startTimer,1e3),paused=!1,document.getElementById("pause").innerHTML="pause",document.getElementById("history").innerHTML+="<p>PLAY:    <b>"+getTimeNow()+"</b></p>"}function stop(){let e=document.getElementById("set_time").value-parseInt(document.getElementById("minutes").innerText)-1;document.getElementById("all_min").innerHTML=parseInt(document.getElementById("all_min").innerHTML)+e,document.getElementById("count_tasks").innerHTML++,document.getElementById("set_time").disabled=!1,document.getElementById("task").disabled=!1,document.getElementById("stop").disabled=!0,paused=!1,document.getElementById("pause").innerHTML="pause",document.getElementById("pause").style.display="none",document.getElementById("start").style.display="inline",document.getElementById("time").innerHTML="",document.getElementById("set").innerHTML=e,document.getElementById("history").innerHTML+="<p>STOP:   <b>"+getTimeNow()+"</b> - "+document.getElementById("task").value+" - <b>"+e+" min</b></p>",clearTimeout(tt),document.getElementById("set_time").value=25}function setup(){document.querySelectorAll(".inputs_set").forEach(e=>{e.addEventListener("keyup",(function(e){13===e.keyCode&&(e.preventDefault(),document.getElementById("start").click())}))})}function task_visible(){"none"==document.getElementById("management").style.display?document.getElementById("management").style.display="block":document.getElementById("management").style.display="none"}setup();